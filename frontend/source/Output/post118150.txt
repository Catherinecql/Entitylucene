Safari 7 can't connect to intranet using HTTP authentication <body> emSee the UPDATE below for new information about the actual HTTP requests going on under the hood./em  So I started a new job back in October. It's mostly a Windows shop, and they use IIS and Active Directory for a bunch of internal stuff. They have an intranet site at codeintranet.companyname.com/code.  In Chrome on Mavericks, when I go there, I get the expected little HTTP auth dropdown:  img src="https://i.stack.imgur.com/9s062.png" alt="What Chrome does; this is the sort of thing I SHOULD be getting in Safari"  where I can type my username and password. I'm not very swift with Active Directory, but I guess codemsgd/code is the Active Directory domain I'm on, so I type codemsgd\lheidbreder/code and my password, and I can log in successfully in Chrome.  Way back in October, the first time I tried this in Safari, I got some weird behavior; like, I saw the password thing, but then it didn't work when I put in my credentials. I don't remember exactly what it did.  But after that first attempt, and on every attempt since then, when I try to go to codeintranet.companyname.com/code, Safari shows a blank screen:  img src="https://i.stack.imgur.com/c8iOW.png" alt="What Safari 7 on Mavericks does when I try to connect to my intranet"  The screen doesn't change, and the progress bar fills up about 20% and stays there.  hr  h3UPDATE/h3  I ran an app to snoop HTTP requests, and I found out what this was doing behind the scenes. It's not just sitting there; Safari is actually requesting the page emalmost 1000 times per second/em, and each time, it gets a 401 error and an HTML error page with the title "You are not authorized to view this page".  On one example request from the middle of a load attempt, Safari sends this codeAuthorization/code header:  precodeNegotiate YEgGBisGAQUFAqA+MDygDjAMBgorBgEEAYI3AgIKoioEKE5UTE1TU1AAAQAAAAUCiGIAAAAAGAAAAAAAAAAYAAAABgGwHQ8AAAA= /code/pre  And the server responds with this codeWWW-Authenticate/code header:  precodeNegotiate oYIBIzCCAR+gAwoBAaEMBgorBgEEAYI3AgIKooIBCASCAQROVExNU1NQAAIAAAAOAA4AOAAAAAUCiWKPhp0o8/Y/9gAAAAAAAAAAvgC+AEYAAAAFAs4OAAAAD0EAUgBJAFMAVwBFAEIAAgAOAEEAUgBJAFMAVwBFAEIAAQAMAE4ARQBXAFcARQBCAAQAKgBhAHIAaQBzAHcAZQBiAC4AYQByAGkAcwB0AG8AdABsAGUALgBuAGUAdAADADgATgBFAFcAVwBFAEIALgBhAHIAaQBzAHcAZQBiAC4AYQByAGkAcwB0AG8AdABsAGUALgBuAGUAdAAFACoAYQByAGkAcwB3AGUAYgAuAGEAcgBpAHMAdABvAHQAbABlAC4AbgBlAHQAAAAAAA== /code/pre  On the next request, Safari sends an identical codeAuthorization/code header, and then the server responds with a very slightly different codeWWW-Authenticate/code header:  precodeNegotiate oYIBIzCCAR+gAwoBAaEMBgorBgEEAYI3AgIKooIBCASCAQROVExNU1NQAAIAAAAOAA4AOAAAAAUCiWLa6vytPOG0owAAAAAAAAAAvgC+AEYAAAAFAs4OAAAAD0EAUgBJAFMAVwBFAEIAAgAOAEEAUgBJAFMAVwBFAEIAAQAMAE4ARQBXAFcARQBCAAQAKgBhAHIAaQBzAHcAZQBiAC4AYQByAGkAcwB0AG8AdABsAGUALgBuAGUAdAADADgATgBFAFcAVwBFAEIALgBhAHIAaQBzAHcAZQBiAC4AYQByAGkAcwB0AG8AdABsAGUALgBuAGUAdAAFACoAYQByAGkAcwB3AGUAYgAuAGEAcgBpAHMAdABvAHQAbABlAC4AbgBlAHQAAAAAAA== /code/pre  Repeat emad infinitum./em  hr  I've tried deleting everything that matches codeintranet/code in Keychain Access and clearing my entire cache/cookies, to see if I could restore the original weird behavior, but it didn't work.  Do I have some kind of funky domain stuff going on? What else can I try to diagnose this?  <answer118494> Keychains was a good idea but you didn't quite go far enough.  In Safari if you look under the codeSafari/code menu you will see codeReset Safari.../code Select this and a number of caches will be cleared.  Now open codeSafari/code  codePreferences/code  codeAutofill/code and turn off codeUser names and passwords/code. Now select codePasswords/code and remove any passwords listed there. Select codePrivacy/code and click on codeRemove All Website Data/code. Select codeExtensions/code and if you have any extensions installed switch extensions to codeOff/code.  Now go and try your website. Once you've made the attempt go and have a look at codePrivacy/code to see if any cookies have been left and codePasswords/code to see if Safari saved your password.  This might get you closer to a solution. Tell us how it goes after that. If Chrome works I'd love to know exactly what it's doing that works. Could a bit more snooping be required?  Just for giggles try the URL codehttp://username:password@intranet.example.com//code (replacing bits obviously) and see what happens.  <answer118580> We are having the same issue.  Thus why we haven't upgraded our Macs to Mavericks yet.  It appears to try to log into the Intranet without domain credentials(Intranet\'blank').  It should be using the domain\username.  I can understand this can be frustrating but it seems that authentication is missing in safari.  I just a few seconds it will blow away logs.  Firefox seems to work great though.  <answer118714> This might be a long shot, but if you have a Kerberos ticket (from signing into another service), Safari might be trying to use that.  Open /System/Library/CoreServices/Ticket Viewer.app to see if you have any Kerberos tickets. If so, click on the ticket, Remove Identity, and try again.  Alternatively, if nothing is listed, try using Add Identity and seeing if that works with Safari.  Firefox and Chrome don't utilize Kerberos, I don't think, which is why they'll prompt you separately for credentials.  <answer119055> I had a similar issue at my office as well. The key was to make sure that my DNS lookup excluded the local (company/intranet) sites from going out to look for a DNS address. That was cause of my system wanting to go out to the proxy and getting the constant log in screen. What was happening is that my request for the url of intranet.company.com was being taken by the proxy server and sent out to the web. The main webserver would see that I was connecting through a company IP and respond looking for credentials that were stripped off by the proxy... I think.  Basically making sure that the intranet site was not being sent to a proxy solved my issue. That plus just making Chrome my default browser...  <answer122628> Use the Ticket Viewer.app, code/System/Library/CoreServices/Ticket Viewer.app/code, and add a new ticket.  In the new ticket, use the username and password for the authentication of intranet url.  <answer123206> I can confirm that I see the identical problem with Safari 7.0.2 (9537.74.9), with all current Mac OS X Mavericks updates installed. (Thousands of request packets per second with the same kind of content as described above.)  However, while this may or may not help the original poster, I have found that this problem only occurs if the Windows server has Integrated Windows Authentication (also known as NTLM Authentication) strongand/strong Negotiate Authentication enabled.  The server then sends these two headers:  precodeWWW-Authenticate: Negotiate WWW-Authenticate: NTLM /code/pre  Safari will reply:  precodeAuthorization: Negotiate YEgGBisGAQUFAqA+MDygDjAMBgorBgEEAYI3AgIKoioEKE5UTE1TU1AAAQAAAAUCiGIAAAAAGAAAAAAAAAAYAAAABgGwHQ8AAAA= /code/pre  And from there, the loop will get going.  But if Negotiate Authentication is not enabled on the server, there will be only one WWW-Authenticate header:  precodeWWW-Authenticate: NTLM /code/pre  And Safari's reply will be something like:  precodeAuthorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA= /code/pre  This will work just fine. Essentially, it seems that Negotiate is broken in Safari, and since the server sends Negotiate first, indicating a preference for it, Safari will try it and enter an infinite loop that prevents it from falling back to NTLM.  So, if the server administrator can be persuaded to turn off Negotiate in the authentication settings, the problem may be solved.  I might add that Firefox sends the "Authorization: NTLM ..." header regardless of whether the server provides Negotiate in addition to NTLM or not. Presumably, Negotiate is not implemented in Firefox.  hr /  h2Update/h2  Safari 7.0.3 (9537.75.14) still exhibits the same problem.  We previously reported the issue as a bug at bugreport.apple.com, but the bug was closed as a duplicate of a previous bug—the contents of which we cannot see, except that it is still marked as open.  h2Update 2/h2  I can confirm hauns's finding that the authentication works with Safari 7.0.4 (9537.76.4).  h2Update 3/h2  This issue is back in Safari 7.0.5 (9537.77.4)  h2Update 4/h2  This issue is still present in Safari 7.0.6 (9537.78.2), as noted by hauns, with cifs or smb volumes mounted.  <answer127695> This may or may not help but I have found that if I connect to an smb share other than myself I lose the Authentication Window in Safari 7.0.3 running OS 10.9.2  Myself as in my active directory login and password. I am bound to an active directory server.  I have not tested this on a non bound machine. I have also tested Chrome and FireFox and these apps have no problem wither way. Aurora does not work either way anymore.  Edit by another user:  This appears to be the cause of the problem. This has now been tested with a non-bound machine running Mavericks and now running Yosemite.  After I connect to SMB shares, Safari will no longer present the authentication dialog.  In Mavericks, as soon as I disconnect from the SMB shares, the dialog is presented and I can log in to my company's Sharepoint 2013 intranet site.  I have no problem on Sharepoint 2007 or other intranet sites.  In Yosemite, it appears that I can connect to a maximum of two SMB shares and Safari will still work. If I am connected to three or more SMB shares, the problem manifests.  I am not sure yet if it is the number of shares or if perhaps the different shares have different permissions that might affect the situation.  I need to do some more rigorous testing on that front.  <answer132177> Safari 7.0.5 still has the issue: authentication breaks down if finder shares network resources via SMB: (or CIFS:). once all connected network volumes are unmounted, Safari resumes proper authentication.  h3Regression:/h3  ol lipresent in Yosemite 10.10.1/Safari 8.0.2/li lipresent in El Capitan 10.11.2/Safari 9.0.2/li lipresent in Safari 10.0.1/li /ol  The corresponding Apple bug 22990203 is still active. No mortal is allowed to see it (cf.bugreporter.apple.com)  See also: https://discussions.apple.com/message/27727310#27727310  <answer139737> ol liCreate a new user on the Mac./li liSwitch to this new user. You may do this while keeping your current session open./li liLaunch Safari. This is a virgin Safari./li liTry to connect to the site. Normally, you will get the authentication dialog./li /ol  <comment138250> Instead of a keychain issue, it is probably related to cookies.  You could try to remove them from the "Privacy" section of the Safari preference pane. <comment138331> There were no passwords or cookies for the `intranet.companyname.com` site, but I cleared them all out anyway, and as expected, I'm getting the exact same behavior. Do note that what I *should* be getting is the browser's HTTP authentication modal, so if it were going to be anywhere, it'd be in Keychain Access, not in cookies. <comment138332> Nope. I commented on the answer below; I cleared cache, cookies, everything, and it does the exact same thing. I should be getting an HTTP authentication popup, so I don't think cookies directly pertain to that. <comment138366> Random thought... did you also check your iCloud keychain (if you are linking your keychain to iCloud, that is)? In Keychain Access, there are separate entries for the _login_ keychain and your _iCloud_ keychain. <comment138469> Added a bit more as it came to me. <comment138700> I don't have anything listed there, and when I try to put in credentials, it says "Incorrect password". <comment138701> A good thought, but I have iCloud Keychain turned off on this computer, and in any case, a search in Keychain Access searches all available keychains. <comment138720> When you're adding the ticket, you're using msgd\lheidbreder as the username, correct? <comment138824> Yep, I sure am. <comment138827> "I[n] just a few seconds it will blow away logs" — Really? I don't show it logging anything in Console.app. What log does it write to for you? <comment138829> Nothing useful happens when I try that URL format. <comment138843> Try it as `https://` as well. <comment138847> We use Solarwinds for our logging.  However it hits the System logs on our intranet server. <comment138869> How about you disable Keychain. Also, when it tells you that simply log in as a "guest" with the password "guest" as well. It would bring you to the page, this happened with me a lot. <comment143183> As indicated above, whenever I try to add a new ticket in that app, it tells me I have a bad username/password combination. I've tried both `lheidbreder` and `msgd\lheidbreder` as my username; no luck. <comment149620> Thanks for the info. You should consider copying your official bug report to [Open Radar](http://openradar.appspot.com/page/1) and linking to it here. <comment157231> I know it won't help you but I just discovered I have exactly the same problem with Safari 7.0.4 and an intranet SharePoint. I can connect fine with Chrome and Firefox but Safari starts loading, as you described, and then just sits there. Very annoying. <comment311226> This issue been resolved in OS X 10.11.5